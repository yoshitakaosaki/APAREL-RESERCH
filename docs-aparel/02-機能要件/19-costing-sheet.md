# 機能要件仕様書 - 19.原価計算機能

## 1. 機能概要

原価計算機能は、製品の材料費から加工費、物流費まで全てのコスト要素を統合管理し、正確な原価計算と収益性分析を実現する機能です。リアルタイムな原価把握により、適切な価格設定と利益確保を支援します。

## 2. 機能要件

### 2.1 コスト構成管理

#### 材料費計算
- **主素材費**:
  - 生地使用量×単価
  - ロス率加算
  - 為替レート適用
  - 運賃/関税加算
- **副資材費**:
  - BOM連動自動集計
  - 付属品単価×数量
  - 包装材費
  - 予備品費
- **材料ロス管理**:
  - 標準ロス率設定
  - 実績ロス率追跡
  - サイズ別ロス
  - 改善提案

#### 加工費計算
- **縫製工賃**:
  - 工程別標準時間
  - 時間単価設定
  - 難易度係数
  - ロット係数
- **特殊加工費**:
  - プリント/刺繍
  - 洗い加工
  - 後加工全般
  - 外注加工費
- **間接労務費**:
  - 検品費用
  - 仕上げ費用
  - 梱包作業費
  - 管理費配賦

### 2.2 諸経費管理

#### 物流費
- **輸送費**:
  - 国内/国際輸送
  - 輸送形態別
  - 保険料
  - 通関費用
- **保管費**:
  - 倉庫料
  - 在庫金利
  - 荷役費
  - 温度管理費

#### 管理費
- **開発費**:
  - デザイン費
  - パターン費
  - サンプル費
  - 型/治具費
- **品質管理費**:
  - 検査費用
  - 試験費用
  - 認証取得費
  - 不良対策費
- **販売管理費**:
  - 営業経費配賦
  - マーケティング費
  - ロイヤリティ
  - 手数料

### 2.3 原価シミュレーション

#### What-if分析
- **変動要因分析**:
  - 材料費変動
  - 為替変動
  - 数量変動
  - 工賃変動
- **シナリオ比較**:
  - 複数案比較
  - 最適化提案
  - リスク分析
  - 感度分析

#### 代替案検討
- **材料代替**:
  - 代替素材での試算
  - 品質-コストバランス
  - 調達可能性考慮
  - 承認プロセス
- **生産地変更**:
  - 工場別見積比較
  - 品質レベル考慮
  - リードタイム影響
  - トータルコスト

### 2.4 収益性分析

#### 利益計算
- **粗利計算**:
  - 販売価格設定
  - 粗利額/率
  - 目標利益率
  - 最低販売価格
- **貢献利益**:
  - 変動費/固定費分離
  - 限界利益率
  - 損益分岐点
  - 目標販売数量

#### KPI管理
- **原価率分析**:
  - 材料費率
  - 加工費率
  - 経費率
  - 改善目標
- **収益性指標**:
  - ROI（投資収益率）
  - 回転率
  - 在庫効率
  - キャッシュフロー

### 2.5 レポート・分析機能

#### 原価明細書
- **詳細内訳**:
  - 費目別明細
  - 構成比表示
  - 前回比較
  - 予実対比
- **サマリー表示**:
  - 主要指標
  - グラフ表示
  - トレンド分析
  - 異常値検出

#### 比較分析
- **時系列分析**:
  - 原価推移
  - 変動要因分析
  - 季節変動
  - 改善効果測定
- **製品間比較**:
  - カテゴリー別
  - ブランド別
  - 仕向地別
  - ABC分析

## 3. UI/UX要件

### 3.1 入力インターフェース
- **積算画面**:
  - 費目別入力
  - 自動計算
  - エラーチェック
  - 承認フロー
- **一括更新**:
  - 為替レート更新
  - 単価一括変更
  - 係数調整
  - シミュレーション

### 3.2 ダッシュボード
- **KPI表示**:
  - リアルタイム更新
  - アラート機能
  - ドリルダウン
  - カスタマイズ
- **分析ツール**:
  - ピボット分析
  - What-if分析
  - トレンド予測
  - 最適化提案

## 4. 連携要件

### 4.1 データ連携
- **BOM連携（05）**:
  - 材料費自動取得
  - 数量連動
  - 更新通知
- **生産連携**:
  - 実績データ取込
  - 差異分析
  - 改善フィードバック

### 4.2 システム連携
- **ERP連携**:
  - 原価データ送信
  - 実績取込
  - 予算管理
- **BI連携**:
  - 分析データ提供
  - KPI連携
  - レポート生成

## 5. バリデーション要件

### 5.1 計算精度
- **数値検証**:
  - 計算式確認
  - 端数処理
  - 為替換算
  - 合計突合

### 5.2 承認管理
- **権限設定**:
  - 入力権限
  - 承認権限
  - 閲覧権限
  - 変更履歴

## 6. 性能要件

- **計算処理**:
  - 原価計算：3秒以内
  - シミュレーション：5秒以内
  - 一括更新：30秒以内
- **レポート生成**:
  - 標準レポート：5秒以内
  - カスタムレポート：10秒以内

## 7. 出力機能

### 7.1 原価資料
- **公式文書**:
  - 原価計算書
  - 見積書
  - 価格設定書
  - 承認申請書

### 7.2 分析資料
- **管理レポート**:
  - 原価分析レポート
  - 収益性レポート
  - 改善提案書
  - 経営ダッシュボード